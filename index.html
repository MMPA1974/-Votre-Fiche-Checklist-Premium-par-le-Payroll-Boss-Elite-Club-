<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Votre Fiche Checklist Premium</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for Inter font and general body styling */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            background: linear-gradient(to bottom right, #F8F8F8, #F0F4F8); /* Softer light mode background */
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .font-inter {
            font-family: 'Inter', sans-serif;
        }
        /* Hide checkbox visually but remain accessible */
        .form-checkbox {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            height: 20px;
            width: 20px;
            border: 2px solid #a78bfa; /* purple-400 */
            border-radius: 0.25rem; /* rounded */
            cursor: pointer;
            display: inline-block;
            vertical-align: middle;
            position: relative;
        }
        .form-checkbox:checked {
            background-color: #8b5cf6; /* purple-600 */
            border-color: #8b5cf6; /* purple-600 */
        }
        .form-checkbox:checked::after {
            content: '‚úî';
            color: white;
            font-size: 14px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .form-checkbox:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(167, 139, 250, 0.5); /* focus:ring-purple-500 */
        }

        /* Light Mode Specific Adjustments for cards/sections */
        .bg-white {
            background-color: #FCFCFC; /* Slightly off-white for elements */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* Default shadow */
        }
        .shadow-lg {
             box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* Enhanced shadow for sections */
        }
        .shadow-md {
             box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* Standard shadow */
        }
        .shadow-xl { /* New shadow for Boss Tips */
             box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .shadow-2xl { /* Even stronger shadow for Boss Tips */
             box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        .shadow-inner {
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06); /* Inner shadow */
        }
        .bg-gray-50 {
            background-color: #F8F8F8; /* Light gray for list items to add nuance */
        }
        .hover\:bg-gray-50:hover {
            background-color: #EFEFEF; /* Slightly darker on hover for contrast */
        }
        /* Alternating background for Boss Tips in light mode */
        .boss-tip-card:nth-child(odd) {
            background-color: #FDF2F8; /* Light pinkish tone */
        }
        .boss-tip-card:nth-child(even) {
            background-color: #EEF2FF; /* Light bluish tone */
        }


        /* Dark Mode Styles */
        body.dark-mode {
            background: #1a202c; /* dark gray */
            color: #e2e8f0; /* light gray text */
        }
        body.dark-mode .bg-white {
            background-color: #2d3748; /* darker gray for cards */
            color: #e2e8f0;
        }
        body.dark-mode .text-indigo-800 {
            color: #9f7aea; /* lighter purple for headings */
        }
        body.dark-mode .text-purple-700 {
            color: #b794f4; /* lighter purple */
        }
        body.dark-mode .text-gray-700 {
            color: #cbd5e0; /* lighter gray */
        }
        body.dark-mode .text-gray-800 {
            color: #f7fafc; /* lightest gray */
        }
        body.dark-mode .border-indigo-200 {
            border-color: #4a5568; /* darker border */
        }
        body.dark-mode .bg-purple-100 {
            background-color: #4c51bf; /* darker purple for table header */
            color: #f7fafc;
        }
        /* Correction for hover in dark mode */
        body.dark-mode .hover\:bg-gray-50:hover {
            background-color: #4a5568; /* a darker shade for hover */
            color: #fca5a5; /* light rose color for text on hover */
        }
        body.dark-mode .bg-gray-50 {
            background-color: #4a5568; /* darker gray for checklist items */
        }
        body.dark-mode .text-purple-800 {
            color: #e2e8f0; /* light text on dark purple */
        }
        body.dark-mode .bg-purple-50 {
            background-color: #4a5568; /* darker purple for skill blocks/tips containers */
        }
        body.dark-mode .shadow-inner {
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.4);
        }
        body.dark-mode .shadow-md {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
        }
        body.dark-mode .shadow-xl { /* New shadow for Boss Tips */
             box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
        }
        body.dark-mode .shadow-2xl { /* Even stronger shadow for Boss Tips */
             box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
        }
        body.dark-mode .border-purple-400 {
            border-color: #8b5cf6; /* brighter purple border */
        }
        body.dark-mode .border-purple-500 {
            border-color: #8b5cf6; /* brighter purple border */
        }
        body.dark-mode .bg-gradient-to-r {
            background-image: linear-gradient(to right, #6b46c1, #5a67d8); /* Adjusted gradient for dark mode */
        }
        body.dark-mode .bg-indigo-600 {
            background-color: #6a7ee0; /* adjusted button color */
        }
        body.dark-mode .hover\\:bg-indigo-700:hover {
            background-color: #5a67d8; /* adjusted button hover color */
        }
        body.dark-mode .bg-green-500 {
            background-color: #48bb78; /* adjusted button color */
        }
        body.dark-mode .hover\\:bg-green-600:hover {
            background-color: #38a169; /* adjusted button hover color */
        }
        /* Alternating background for Boss Tips in dark mode */
        .dark-mode .boss-tip-card:nth-child(odd) {
            background-color: #3c3b52; /* Darker pinkish tone for dark mode */
        }
        .dark-mode .boss-tip-card:nth-child(even) {
            background-color: #323d57; /* Darker bluish tone for dark mode */
        }


        /* Global Progress Bar Styling */
        .global-progress-bar-container {
            height: 25px; /* Thicker bar */
            border-radius: 9999px; /* Fully rounded */
            background-color: #e2e8f0; /* Light gray track */
            overflow: hidden; /* Hide overflow from inner bar */
            position: relative;
            box-shadow: inset 0 1px 3px 0 rgba(0, 0, 0, 0.1); /* Subtle inner shadow */
        }
        .global-progress-bar {
            height: 100%;
            border-radius: 9999px;
            background: linear-gradient(to right, #a78bfa, #6b46c1); /* Purple to Indigo gradient */
            text-align: center;
            color: #FECDD6; /* light rose color for text on light background */
            font-size: 0.875rem; /* text-sm, increased from 0.75rem */
            font-weight: 500; /* Medium font weight, for readability */
            display: flex;
            align-items: center;
            justify-content: center; /* Center text horizontally */
            transition: width 0.5s ease-in-out; /* Smooth transition */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* 3D effect shadow */
            white-space: nowrap; /* Keep text on one line */
            overflow: hidden; /* Hide overflowing text */
            text-overflow: ellipsis; /* Add ellipsis if text overflows */
            padding: 0 0.5rem; /* Add some padding to prevent text touching edges */
        }
        body.dark-mode .global-progress-bar-container {
            background-color: #4a5568; /* Darker track for dark mode */
            box-shadow: inset 0 1px 3px 0 rgba(0, 0, 0, 0.4);
        }
        body.dark-mode .global-progress-bar {
            background: linear-gradient(to right, #8b5cf6, #6a7ee0); /* Adjusted gradient for dark mode */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
            color: #e2e8f0; /* Light text for dark background */
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-purple-100 to-indigo-200 p-4 sm:p-6 lg:p-8">

    <div class="flex justify-end space-x-4 mb-4">
        <button id="darkModeToggle" class="bg-gray-700 hover:bg-gray-800 text-white font-semibold py-2 px-4 rounded-full shadow-md transition duration-300 ease-in-out transform hover:scale-105">
            üåì Mode Sombre
        </button>
        <button id="soundToggle" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-full shadow-md transition duration-300 ease-in-out transform hover:scale-105">
            üîä G√©rer le Son
        </button>
        </div>

    <header class="text-center mb-8 bg-white p-6 rounded-xl shadow-lg">
        <h1 class="text-3xl sm:text-4xl font-bold text-indigo-800 mb-2">
            üéâ Votre Fiche Checklist Premium
        </h1>
        <p class="text-xl sm:text-2xl text-purple-700 font-semibold mb-4">
            par le <span class="text-orange-500">üî• Payroll Boss Elite Club üëë</span> !
        </p>
        <p class="text-md sm:text-lg text-gray-700 mb-4">
            Bienvenue, Future Boss de la Paie ! üöÄ Pr√©parez-vous √† atteindre vos objectifs avec cette fiche personnalis√©e qui va faire √©clater votre potentiel ! üåü Cochez chaque √©tape et ressentez la puissance de l'organisation ! üí™üíñ
        </p>
        <div class="flex flex-wrap justify-center gap-4 text-sm sm:text-base">
            <a
                href="https://discord.gg/cBnBkGDFgk"
                target="_blank"
                rel="noopener noreferrer"
                class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-full shadow-md transition duration-300 ease-in-out transform hover:scale-105"
            >
                Discord : üî•Payroll Boss Elite Club üëë| Infos & Actus
            </a>
            <a
                href="https://wa.me/"
                target="_blank"
                rel="noopener noreferrer"
                class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-full shadow-md transition duration-300 ease-in-out transform hover:scale-105"
            >
                WhatsApp : üî• Payroll Boss Elite Club : Le Hub Paie & Progr√®s üìà
            </a>
        </div>
    </header>

    <section class="text-center mb-8 bg-white p-6 rounded-xl shadow-lg border-l-4 border-purple-500">
        <div class="mb-4 flex flex-wrap justify-center gap-4">
            <label class="inline-flex items-center">
                <input type="radio" class="form-radio text-purple-600 h-5 w-5" name="promotion" value="vinci" id="promoVinci" checked>
                <span class="ml-2 text-lg font-medium text-gray-700">Promotion VINCI</span>
            </label>
            <label class="inline-flex items-center">
                <input type="radio" class="form-radio text-purple-600 h-5 w-5" name="promotion" value="pasteur" id="promoPasteur">
                <span class="ml-2 text-lg font-medium text-gray-700">Promotion PASTEUR</span>
            </label>
            <label class="inline-flex items-center">
                <input type="radio" class="form-radio text-purple-600 h-5 w-5" name="promotion" value="copernic" id="promoCopernic">
                <span class="ml-2 text-lg font-medium text-gray-700">Promotion COPERNIC</span>
            </label>
        </div>
        <div class="mb-4">
            <label class="inline-flex items-center mr-6">
                <input type="radio" class="form-radio text-purple-600 h-5 w-5" name="promotionSession" value="session1" id="radioSession1" checked>
                <span class="ml-2 text-lg font-medium text-gray-700">Session 1</span>
            </label>
            <label class="inline-flex items-center">
                <input type="radio" class="form-radio text-purple-600 h-5 w-5" name="promotionSession" value="session2" id="radioSession2">
                <span class="ml-2 text-lg font-medium text-gray-700">Session 2</span>
            </label>
        </div>
        <p class="text-2xl sm:text-3xl font-bold text-gray-800 mb-2">
            ‚è≥ J-<span id="days-remaining">0</span> avant la <span id="current-promotion-display">Promotion VINCI</span> (<span id="promotion-date">27/10/2025</span>) !
        </p>
        <p class="text-gray-600 text-sm mt-2 mb-4">
            (Note : Ce compte √† rebours est dynamique, affichant le nombre de jours restants jusqu'√† la promotion.)
        </p>

        <h3 class="text-lg sm:text-xl font-bold text-gray-800 mb-2">üìä Moyenne de votre Avanc√©e (Tous Blocs) :</h3>
        <div id="global-progress-bar-section" class="w-full global-progress-bar-container">
            <div class="global-progress-bar" style="width: 0%;">
                0%
            </div>
        </div>
    </section>

    <main class="max-w-6xl mx-auto">
        <section class="mb-8 bg-white p-6 rounded-xl shadow-lg">
            <h2 class="text-2xl sm:text-3xl font-bold text-indigo-700 mb-6 border-b-2 pb-2 border-indigo-200">
                ‚úÖ Checklist Acad√©mique : Ma Roadmap vers le Succ√®s ! üéì
            </h2>
            <p class="text-gray-700 mb-4 text-lg">
                üéØ Toutes les √âtapes de votre Roadmap par Session !
            </p>
            <div class="overflow-x-auto">
                <table class="min-w-full bg-white rounded-lg shadow-inner">
                    <thead class="bg-purple-100">
                        <tr>
                            <th class="py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider rounded-tl-lg">
                                Action
                            </th>
                            <th class="py-3 px-4 text-center text-sm font-semibold text-gray-700 uppercase tracking-wider">
                                Session 1
                            </th>
                            <th class="py-3 px-4 text-center text-sm font-semibold text-gray-700 uppercase tracking-wider">
                                Session 2
                            </th>
                        </tr>
                    </thead>
                    <tbody id="academic-checklist-body" class="divide-y divide-gray-200">
                        </tbody>
                </table>
            </div>
        </section>

        <section class="mb-8 bg-white p-6 rounded-xl shadow-lg">
            <h2 class="text-2xl sm:text-3xl font-bold text-indigo-700 mb-6 border-b-2 pb-2 border-indigo-200">
                üöÄ D√©marrage & Pr√©paration G√©n√©rale !
            </h2>
            <div id="general-preparation-list" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                </div>
        </section>

        <section class="mb-8 bg-white p-6 rounded-xl shadow-lg">
            <h2 class="text-2xl sm:text-3xl font-bold text-indigo-700 mb-6 border-b-2 pb-2 border-indigo-200">
                üß† Ma√Ætrise des Blocs de Comp√©tences !
            </h2>

            <div id="skill-blocks-container">
                </div>
        </section>

        <section class="mb-8 bg-white p-6 rounded-xl shadow-lg">
            <h2 class="text-2xl sm:text-3xl font-bold text-indigo-700 mb-6 border-b-2 pb-2 border-indigo-200">
                üåü Checklist Bien-√™tre & √âquilibre : La Boss que vous √™tes ! üíñ
            </h2>
            <p class="text-gray-700 mb-4 text-lg">
                Parce qu'une Boss de la Paie au top, c'est aussi une Boss √©panouie et sereine ! ‚ú® Prenez soin de vous, c'est la cl√© de la r√©ussite durable !
            </p>

            <div id="wellbeing-checklist-container">
                </div>
        </section>

        <section class="mb-8 bg-white p-6 rounded-xl shadow-lg" id="boss-tips-section">
            <h2 class="text-2xl sm:text-3xl font-bold text-indigo-700 mb-6 border-b-2 pb-2 border-indigo-200">
                üí° Conseils de Boss pour une Pr√©paration au TOP du TOP ! üìà
            </h2>

            <div class="space-y-12"> <div class="boss-tip-card p-8 rounded-xl shadow-2xl border-l-4 border-purple-400"> <h3 class="text-xl font-semibold text-purple-800 mb-2">
                        üóìÔ∏è √Ä 2 mois de l'examen : Le Grand D√©marrage ! üöÄ
                    </h3>
                    <p class="text-gray-700">
                        C'est le moment de poser les fondations de votre succ√®s ! üß± Plongez dans les bases de chaque module, organisez un emploi du temps de r√©vision qui vous ressemble (et que vous allez ADORER suivre ! üòâ). Identifiez vos zones de g√©nie et celles qui demandent un petit coup de boost pour y mettre toute votre √©nergie ! üéØ
                    </p>
                </div>

                <div class="boss-tip-card p-8 rounded-xl shadow-2xl border-l-4 border-purple-400">
                    <h3 class="text-xl font-semibold text-purple-800 mb-2">
                        üóìÔ∏è √Ä 1 mois de l'examen : L'Acc√©l√©ration Finale ! ‚ö°
                    </h3>
                    <p class="text-gray-700">
                        On passe √† la vitesse sup√©rieure ! üöÄ Intensifiez vos r√©visions, d√©fiez-vous avec des annales d'examens et des exercices types. C'est le terrain de jeu id√©al pour ma√Ætriser votre temps et apprivoiser le stress comme une vraie Boss ! üëë Pratiquez, pratiquez, pratiquez ! üß†‚ú®
                    </p>
                </div>

                <div class="boss-tip-card p-8 rounded-xl shadow-2xl border-l-4 border-purple-400">
                    <h3 class="text-xl font-semibold text-purple-800 mb-2">
                        üóìÔ∏è √Ä 1 semaine de l'examen : La S√©r√©nit√© avant la Temp√™te ! üßò‚Äç‚ôÄÔ∏è
                    </h3>
                    <p class="text-gray-700">
                        Stop aux nouvelles notions ! üö´ C'est la semaine de la consolidation et du bien-√™tre. Assurez-vous que tout votre arsenal pour l'examen est pr√™t (stylos chanceux, chargeurs, etc. !). üçÄ Priorit√© absolue : un sommeil de champion(ne) et une alimentation qui vous donne des super-pouvoirs ! üçéüò¥
                    </p>
                </div>

                <div class="boss-tip-card p-8 rounded-xl shadow-2xl border-l-4 border-purple-400">
                    <h3 class="text-xl font-semibold text-purple-800 mb-2">
                        üóìÔ∏è 2 jours avant l'examen & le Jour J : La Victoire est en Vue ! üèÜ
                    </h3>
                    <p class="text-gray-700 mb-2">
                        ON ARR√äTE TOUT ! üõë Oui, oui, vous avez bien lu ! C'est le moment de d√©compresser et de recharger les batteries. Voici quelques astuces pour ces derniers jours cruciaux :
                    </p>
                    <ul class="list-disc list-inside text-gray-700 space-y-1 ml-4">
                        <li><span class="font-semibold">Bureau au top :</span> üßπ Pr√©pare ton espace de travail : d√©gag√©, propre, avec juste l'essentiel. Mieux vaut la qualit√© que la quantit√© de bouquins !</li>
                        <li><span class="font-semibold">Tech check :</span> üíª V√©rifie que ton ordi, tes √©crans, et tous tes outils (t√©l√©phone, etc.) fonctionnent et sont bien charg√©s. Pense √† un deuxi√®me √©cran si tu en as besoin, on ne sait jamais !</li>
                        <li><span class="font-semibold">Zone z√©ro d√©rangement :</span> ü§´ Assure-toi d'√™tre dans un espace isol√©. N'h√©site pas √† mettre un panneau "NE PAS D√âRANGER - RISQUE DE MORSURE" sur ta porte ! üòÇ</li>
                        <li><span class="font-semibold">Ambiance parfaite :</span> üí° Lumi√®re agr√©able, bien a√©r√©, ni trop chaud, ni trop froid. Tes lunettes/lentilles √† port√©e de main !</li>
                        <li><span class="font-semibold">Hydratation & √©nergie :</span> üíß De quoi boire (beaucoup d'EAU, pas de sucre !) et grignoter sainement (pas un repas complet !). Respecte ta pause d√©jeuner si tu bosses toute la journ√©e.</li>
                        <li><span class="font-semibold">Stop quand il faut :</span> ‚è∞ Si apr√®s 3h-3h30 tu sens que tu en peux plus, STOP ! Ferme tout, prends une vraie pause (sieste, promenade), et reviens calmement. Pas de panique ! "√Ä tout probl√®me, il y a deux solutions : la bonne et la bonne. Si tu ne trouves pas de r√©ponse √† ta probl√©matique, c'est qu'il n'y a pas de probl√®me." üòâ</li>
                    </ul>
                    <p class="text-gray-700 mt-4 mb-2 font-semibold">
                        Le Jour J, soyez pr√™te comme jamais :
                    </p>
                    <ul class="list-disc list-inside text-gray-700 space-y-1 ml-4">
                        <li><span class="font-semibold">Dernier check bureau :</span> ‚úÖ Ton bureau est pr√™t depuis 2 jours, mais v√©rifie une derni√®re fois que personne n'y a touch√© (surtout si tu as des enfants !). Ta trousse, tes crayons, tout est l√† ?</li>
                        <li><span class="font-semibold">Projection & Look de Boss :</span> üíº Pr√©pare tes v√™tements la veille. Projette-toi : "Demain, je suis une gestionnaire de paie, je vais au bureau, je vais traiter ma paie." Habille-toi comme si tu allais vraiment travailler !</li>
                        <li><span class="font-semibold">Bien-√™tre matinal :</span> üöø Une bonne douche fra√Æche (si c'est l'√©t√© ou si tu aimes !), un super petit-d√©jeuner.</li>
                        <li><span class="font-semibold">Mindset de champion(ne) :</span> üßò‚Äç‚ôÄÔ∏è Si tu aimes, fais un peu de m√©ditation. Pense aux Quatre Accords Tolt√®ques (et au cinqui√®me !). Laisse ces pens√©es tourner en boucle, c'est reposant.</li>
                        <li><span class="font-semibold">Amuse-toi !</span> üé≠ Prends √ßa comme un jeu, une pi√®ce de th√©√¢tre o√π tu es la star. √âclate-toi, c'est comme √ßa qu'il faut prendre la vie ! Imagine que tu as des coll√®gues, que tu es d√©j√† √† ton poste.</li>
                    </ul>
                    <p class="text-center text-lg font-bold text-purple-700 mt-4">
                        Tu es une Payroll Boss Elite ! La confiance est ton super-pouvoir ! ‚ú®
                    </p>
                </div>
            </div>
        </section>
    </main>

    <footer class="text-center mt-8 bg-white p-6 rounded-xl shadow-lg">
        <button
            onclick="window.print()"
            class="bg-orange-500 hover:bg-orange-600 text-white font-semibold py-3 px-6 rounded-full shadow-md transition duration-300 ease-in-out transform hover:scale-105 mb-4"
        >
            üñ®Ô∏è Imprimer ma Checklist
        </button>
        <p class="text-gray-700 mb-4">
            Ou rejoignez-nous directement pour plus de soutien :
        </p>
        <div class="flex flex-wrap justify-center gap-4 text-sm sm:text-base">
            <a
                href="https://discord.gg/cBnBkGDFgk"
                target="_blank"
                rel="noopener noreferrer"
                class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-full shadow-md transition duration-300 ease-in-out transform hover:scale-105"
            >
                Discord : üî•Payroll Boss Elite Club üëë| Infos & Actus
            </a>
            <a
                href="https://wa.me/"
                target="_blank"
                rel="noopener noreferrer"
                class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-full shadow-md transition duration-300 ease-in-out transform hover:scale-105"
            >
                WhatsApp : üî• Payroll Boss Elite Club : Le Hub Paie & Progr√®s üìà
            </a>
        </div>
    </footer>

    <script>
        let checklistState = {};

        const defaultChecklistState = {
            // Academic Checklist
            'academic': {
                'Pr√©parer son mat√©riel d\'examen (stylos, chargeurs, etc.)': { 'Session 1': false, 'Session 2': false },
                'V√©rifier les modalit√©s sp√©cifiques des √©preuves (asynchrone, non-chronom√©tr√©)': { 'Session 1': false, 'Session 2': false },
                'S\'assurer de l\'acc√®s √† la copie √† rendre (cliquer "activer les modifications")': { 'Session 1': false, 'Session 2': false },
                'R√©aliser les √©preuves √©crites/vid√©o': { 'Session 1': false, 'Session 2': false },
                'G√©rer la p√©riode "Exam Week / Sprint Examen" (r√©visions cibl√©es, questions-r√©ponses)': { 'Session 1': false, 'Session 2': false },
                'Consulter les Lives Sprint Examen': { 'Session 1': false, 'Session 2': false },
                'Poser les derni√®res questions sur le forum/aux responsables p√©dagogiques': { 'Session 1': false, 'Session 2': false },
                'Recevoir les r√©sultats de la session': { 'Session 1': false, 'Session 2': false },
                'Analyser ses r√©sultats et identifier les blocs/√©preuves valid√©s': { 'Session 1': false, 'Session 2': false },
                'Recevoir les bulletins de notes provisoires': { 'Session 1': false, 'Session 2': false },
                'Confirmer la validation des comp√©tences acquises': { 'Session 1': false, 'Session 2': false },
                'Recevoir les Parchemins / Attestation de blocs/bulletins finaux par mail': { 'Session 1': false, 'Session 2': false },
                'C√©l√©brer sa r√©ussite et se projeter vers la suite !': { 'Session 1': false, 'Session 2': false },
            },
            // General Preparation
            'general': {
                'V√©rifier son Profil': false,
                'R√©aliser les 3 Certificats Studi (QCM par bloc)': false,
                'Consulter les diff√©rents guides (Formation, Blocs)': false,
                'S\'assurer d\'avoir bien abord√© la formation (guides, lives de bienvenue et de rentr√©e)': false,
                'R√©aliser toutes les √©valuations d\'entra√Ænement (fortement recommand√©)': false,
                'Poser ses questions sur le forum': false,
            },
            // Skill Blocks
            'bloc1': {
                'Module 1 : Param√©trer le logiciel de paie': {
                    'T√©l√©charger le logiciel': false,
                    'La base de donn√©es 2019': false,
                    'Lancement de l\'application': false,
                    'D√©couverte de l\'application': false,
                    'La cr√©ation d\'une soci√©t√©': false,
                    'Le param√©trage d\'une soci√©t√©': false,
                    'Le param√©trage de l\'√©tablissement': false,
                    'La cr√©ation des fiches salari√©s': false,
                    'Le param√©trage des bulletins mod√®les': false,
                    'Le param√©trage du salaire brut': false,
                    'Le param√©trage des cotisations sociales': false,
                    'Le param√©trage des salaires nets': false,
                    'Les d√©clarations sociales': false,
                    'Questions fr√©quentes': false,
                    'L\'Acc√®s √† d\'autres logiciels de paie': false,
                    'Synth√®se et application : Param√©trer le logiciel de paie': false,
                },
                'Module 2 : Collecter et traiter les variables de paie': {
                    'Comment et pourquoi se former √† la collecte et au calcul des variables de paie': false,
                    'Pr√©sentation de la Gestion de la Paie': false,
                    'La gestion de la paie (pour d√©butants)': false,
                    'Le temps de travail': false,
                    'La r√©mun√©ration': false,
                    'La pr√©sentation et la m√©thodologie du bulletin de salaire': false,
                    'Le r√®glement du salaire': false,
                    'Application : Collecter et traiter les variables de paie': false,
                },
                'Module 3 : G√©rer la r√©mun√©ration': {
                    'La pr√©sentation et la m√©thodologie du bulletin de salaire': false,
                    'Le r√®glement du salaire': false,
                    'La r√©mun√©ration brute : l\'acquisition et la prise de cong√©s pay√©s': false,
                    'La r√©mun√©ration brute : l‚Äôindemnit√© de cong√©s pay√©s': false,
                    'La r√©mun√©ration brute : les heures compl√©mentaires': false,
                    'Pr√©sentation de la r√©mun√©ration brute et de la dur√©e l√©gale du travail': false,
                    'Pr√©sentation de la r√©mun√©ration brute et le temps de travail effectif': false,
                    'La r√©mun√©ration brute : le salaire de base, les primes et la retenue pour absence': false,
                    'La r√©mun√©ration brute : les heures suppl√©mentaires et le dimanche travaill√©': false,
                    'La r√©mun√©ration brute : les heures suppl√©mentaires': false,
                    'La r√©mun√©ration brute : les avantages en nature': false,
                    'La r√©mun√©ration brute : l‚Äôarr√™t de travail, la retenue pour absence, la subrogation et les IJSS': false,
                    'La r√©mun√©ration brute : l‚Äôarr√™t de travail et le compl√©ment employeur': false,
                    'La gr√®ve et le lock-out': false,
                },
                'Module 4 : Traiter les bulletins de salaires': {
                    'Le bulletin de salaire d\'un dirigeant sans contrat de travail': false,
                    'L\'activit√© partielle': false,
                    'Le bulletin de salaire VRP': false,
                    'Le bulletin de salaire du BTP (ouvrier)': false,
                    'Le bulletin de salaire du BTP (ETAM et Cadres)': false,
                    'Le bulletin de salaire Apprenti': false,
                    'La gratification stagiaire': false,
                    'Synth√®se et application : Collecter et traiter les variables de paie': false,
                },
                'Module 5 : Contr√¥ler et √©diter les Bulletins de paie': {
                    'Les diverses cotisations sociales': false,
                    'Les bases de calcul des cotisations sociales': false,
                    'Les r√©ductions de cotisations sociales': false,
                    'Les r√©gularisations de cotisations sociales': false,
                    'Le salaire net et le salaire imposable': false,
                    'Les impacts du pr√©l√®vement √† la source': false,
                    'Le salaire net √† payer et le net social': false,
                    'Synth√®se et application : Contr√¥ler et √©diter les Bulletins de paie': false,
                },
                'Module 6 : G√©rer les d√©clarations sociales': {
                    'Comment et pourquoi se former √† l\'√©dition et au contr√¥le des d√©clarations sociales': false,
                    'Le livre de paie': false,
                    'Les modalit√©s d√©claratives': false,
                    'Le contenu des d√©clarations sociales : la r√©duction g√©n√©rale et TEPA': false,
                    'Le contenu des d√©clarations sociales : les cotisations, le PAS et les contributions sociales': false,
                    'La gestion des arr√™ts de travail en paie': false,
                    'La taxe d\'apprentissage': false,
                    'La gestion de la d√©claration d\'emploi des travailleurs handicap√©s': false,
                    'Les taxes sur les salaires': false,
                    'La participation √† la formation continue': false,
                    'L\'investissement obligatoire dans la construction': false,
                    'Synth√®se et application : G√©rer les d√©clarations sociales': false,
                },
                'Module 7 : Analyser les √©carts entre la paie et la comptabilit√©': {
                    'Les enjeux de l\'identification et l\'analyse des √©carts entre la paie et la comptabilit√©': false,
                    'La pr√©sentation du plan comptable : g√©n√©ralit√©s': false,
                    'Le grand livre comptable et les donn√©es paie': false,
                    'Les op√©rations comptables issues de la paie': false,
                    'Comptabilisation de la paie': false,
                    'L\'analyse des causes': false,
                    'L\'analyse des risques': false,
                    'Les op√©rations de r√©gularisations': false,
                    'Synth√®se et application : Analyser les √©carts entre la paie et la comptabilit√©': false,
                },
            },
            'bloc2': {
                'Module 1 : Etablir les contrats de travail': {
                    'La notion de droit du travail': false,
                    'La formation du contrat de travail': false,
                    'Ma√Ætriser la r√©daction d‚Äôun contrat de travail': false,
                    'L‚Äôex√©cution du contrat de travail': false,
                    'Le contrat de travail √† dur√©e ind√©termin√©e': false,
                    'Le CDD et le contrat de travail temporaire': false,
                    'Le contrat de travail √† temps partiel': false,
                    'Les contrats de formation': false,
                    'La r√©daction du contrat de travail': false,
                    'Synth√®se et application : Etablir les contrats de travail': false,
                },
                'Module 2 : Traiter les entr√©es et sorties des salari√©s': {
                    'Comment et pourquoi se former √† gestion des parcours salari√©s': false,
                    'Le recrutement': false,
                    'Les formalit√©s administratives d\'embauche': false,
                    'La suspension du contrat de travail': false,
                    'L\'√©dition des documents de suspension du contrat': false,
                    'La rupture du contrat de travail : introduction': false,
                    'Le licenciement': false,
                    'Les autres modes de rupture du contrat de travail': false,
                    'Les fins de contrat : cas du CDD, ICP, Indemnit√© RTT, ...': false,
                    'Les fins de contrat : rupture conventionnelle, d√©part et mise √† la retraite': false,
                    'Les formalit√©s de rupture du contrat de travail': false,
                    'L\'√©dition des documents de fin de contrat': false,
                    'Synth√®se et application : Traiter les entr√©es et sorties des salari√©s': false,
                },
                'Module 3 : G√©rer les dossiers du personnel': {
                    'La strat√©gie globale de digitalisation de l\'entreprise': false,
                    'La transition num√©rique': false,
                    'La digitalisation de la fonction RH': false,
                    'La digitalisation des dossiers du personnel': false,
                    'Le coffre fort num√©rique': false,
                    'RGPD : R√®glement G√©n√©ral de Protection des Donn√©es': false,
                    'Synth√®se et application : G√©rer les dossiers du personnel': false,
                },
                'Module 4 : Communiquer avec les partenaires externes': {
                    'Les partenaires externes du service paie': false,
                    'Les outils de communication du service paie avec ses partenaires': false,
                    'Les contr√¥les de l‚Äôapplication du droit du travail': false,
                    'Le contentieux de la relation de travail': false,
                    'Les proc√©dures de r√®glement des conflits collectifs': false,
                    'Les contr√¥les et le contentieux social': false,
                    'Le r√¥le et le contr√¥le de l\'URSSAF': false,
                    'Synth√®se et application : Communiquer avec les partenaires externes': false,
                },
            },
            'bloc3': {
                'Module 1 : R√©aliser une veille juridique': {
                    'Le conseil et l\'assistance √† la direction et aux collaborateurs': false,
                    'La d√©marche de veille': false,
                    'La veille juridique': false,
                    'Les diff√©rents types de veille': false,
                    'La notion de droit du travail': false,
                    'Les sources professionnelles du droit du travail': false,
                    'La hi√©rarchie des sources du droit du travail': false,
                    'La protection sociale, g√©n√©ralit√©s': false,
                    'La formation professionnelle': false,
                    'Les pouvoirs de l‚Äôemployeur et la protection de la sant√© des salari√©s': false,
                    'Comment effectuer une veille active': false,
                    'Le support de communication de la veille juridique': false,
                    'Synth√®se et application : R√©aliser une veille juridique': false,
                },
                'Module 2 : Diagnostiquer le conformit√© de la paie': {
                    'L\'analyse documentaire': false,
                    'La collecte des informations aupr√®s des d√©cideurs': false,
                    'L\'identification des √©carts': false,
                    'L\'identification des risques encourus': false,
                    'Les actions correctrices': false,
                    'Le rapport de diagnostic': false,
                    'Synth√®se et application : Diagnostiquer le conformit√© de la paie': false,
                },
                'Module 3 : Communiquer avec les collaborateurs et managers': {
                    'Les fondamentaux de la communication professionnelle': false,
                    'L\'√©coute active': false,
                    'La communication non verbale': false,
                    'Les fondamentaux de la prise de parole en public': false,
                    'Les r√©unions √† distances': false,
                    'R√©diger une r√©ponse professionnelle': false,
                    'Les fondamentaux de la s√©curit√© sociale': false,
                    'L‚Äôassurance maladie du r√©gime g√©n√©ral': false,
                    'L‚Äôassurance vieillesse du r√©gime g√©n√©ral': false,
                    'La protection contre le ch√¥mage': false,
                    'Synth√®se et application : Communiquer avec les collaborateurs et managers': false,
                },
                'Module 4 : Concevoir des supports de reporting et d‚Äôaide √† la d√©cision': {
                    'Les fondamentaux d\'excel': false,
                    'Le calcul des effectifs': false,
                    'Le bilan social': false,
                    'Le recueil pr√©alable des informations RH': false,
                    'L\'√©dition des tableaux de bord sociaux': false,
                    'L\'analyse et le suivi des tableaux de bord sociaux': false,
                    'L\'analyse et la pr√©vision de la masse salariale': false,
                    'L‚Äôassociation des salari√©s aux performances de l‚Äôentreprise, g√©n√©ralit√©s': false,
                    'La participation': false,
                    'L\'int√©ressement': false,
                    'Les plans d‚Äô√©pargne salariale': false,
                    'Synth√®se et application : Concevoir des supports de reporting et d‚Äôaide √† la d√©cision': false,
                },
                'Module 5 : Assister les utilisateurs du SIRH': {
                    'L\'utilisation d\'un SIRH': false,
                    'Les enjeux d\'un SIRH': false,
                    'Les fonctionnalit√©s du SIRH': false,
                    'La r√©glementation inh√©rente aux SIRH': false,
                    'Introduction √† la notion de base de donn√©es': false,
                    'L\'exploitation des bases de donn√©es': false,
                    'L\'utilisation du SIRH au quotidien par le collaborateur': false,
                    'Proder Talentsoft ou cornerstone': false,
                    'La r√©daction des courriers √† destination du personnel': false,
                    'Synth√®se et application : Assister les utilisateurs du SIRH': false,
                },
            },
            // Well-being Checklist
            'wellbeing': {
                'Moi, ma bulle de bonheur !': {
                    'Prendre un moment pour soi (soin, lecture, m√©ditation, un bon bain moussant !)': false,
                    'Faire une activit√© physique l√©g√®re (promenade, yoga, danse endiabl√©e !)': false,
                    'S\'accorder une pause "plaisir" (film, musique, hobby, ou juste ne rien faire !)': false,
                    'D√©connecter des √©crans au moins 1h avant de dormir (bye bye le t√©l√©phone !)': false,
                    'Faire des exercices de respiration ou de pleine conscience (pour une z√©nitude absolue !)': false,
                },
                'Mon corps, mon temple !': {
                    'Pr√©parer des repas √©quilibr√©s et ultra-gourmands pour la semaine (miam !)': false,
                    'Dormir au moins 7-8 heures par nuit (le sommeil, c\'est sacr√© !)': false,
                    'Boire suffisamment d\'eau tout au long de la journ√©e (hydratation = super-pouvoirs !)': false,
                },
                'Ma tribu, ma force !': {
                    'Passer du temps de qualit√© avec la famille/les enfants (rires garantis !)': false,
                    'Organiser une sortie ou un appel avec des amis/partenaire (partage et bonne humeur !)': false,
                },
            },
        };

        const promotionDates = {
            'vinci': {
                name: 'Promotion VINCI',
                session1: {
                    date: new Date('2025-10-27T11:00:00'),
                    display: '27/10/2025'
                },
                session2: {
                    date: new Date('2026-01-13T11:00:00'),
                    display: '13/01/2026'
                },
                newsletter: 'https://app.comptalia.com/v3/blog'
            },
            'pasteur': {
                name: 'Promotion PASTEUR',
                session1: {
                    date: new Date('2026-05-12T11:00:00'),
                    display: '12/05/2026'
                },
                session2: {
                    date: new Date('2026-07-07T11:00:00'),
                    display: '07/07/2026'
                },
                newsletter: 'https://app.comptalia.com/v3/blog'
            },
            'copernic': {
                name: 'Promotion COPERNIC',
                session1: {
                    date: new Date('2026-10-26T11:00:00'),
                    display: '26/10/2026'
                },
                session2: {
                    date: new Date('2027-01-12T11:00:00'),
                    display: '12/01/2027'
                },
                newsletter: 'https://app.comptalia.com/v3/blog'
            }
        };

        let currentPromotion = 'vinci'; // Default selected promotion
        let currentSession = 'session1'; // Default selected session
        let isDarkMode = false;
        let isSoundMuted = true;

        // Function to play sound using Web Audio API (simple click/tone)
        let audioContext;
        let gainNode;

        function playSound() {
            if (isSoundMuted) return;

            // Initialize AudioContext if not already done
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                gainNode = audioContext.createGain();
                gainNode.connect(audioContext.destination);
            }

            // Create an oscillator for the click sound
            const oscillator = audioContext.createOscillator();
            oscillator.type = 'sine'; // Sine wave for a clean tone
            oscillator.frequency.setValueAtTime(440, audioContext.currentTime); // A4 note (440 Hz)

            // Connect oscillator to gain node, and gain node to destination
            oscillator.connect(gainNode);

            // Start the oscillator
            oscillator.start(audioContext.currentTime);

            // Stop the sound after a very short duration to make it a click
            oscillator.stop(audioContext.currentTime + 0.05); // Stop after 50ms
        }

        // Function to load settings from localStorage
        function loadSettings() {
            const savedState = localStorage.getItem('payrollChecklistState');
            let loadedState = savedState ? JSON.parse(savedState) : {};

            checklistState = JSON.parse(JSON.stringify(defaultChecklistState));

            // Merge saved state into default state to preserve new additions
            function mergeStates(target, source) {
                for (const key in source) {
                    if (source.hasOwnProperty(key)) {
                        if (typeof source[key] === 'object' && source[key] !== null && !Array.isArray(source[key])) {
                            if (!target.hasOwnProperty(key) || typeof target[key] !== 'object' || target[key] === null || Array.isArray(target[key])) {
                                target[key] = source[key];
                            } else {
                                mergeStates(target[key], source[key]);
                            }
                        } else {
                            target[key] = source[key];
                        }
                    }
                }
            }
            mergeStates(checklistState, loadedState);

            const savedPromotion = localStorage.getItem('selectedPromotion');
            const savedSession = localStorage.getItem('selectedSession');
            const savedDarkMode = localStorage.getItem('darkMode');
            const savedSoundMuted = localStorage.getItem('soundMuted');


            if (savedPromotion && promotionDates[savedPromotion]) {
                currentPromotion = savedPromotion;
            }
            if (savedSession && ['session1', 'session2'].includes(savedSession)) {
                currentSession = savedSession;
            }

            if (savedDarkMode !== null) {
                isDarkMode = JSON.parse(savedDarkMode);
            }
            if (savedSoundMuted !== null) {
                isSoundMuted = JSON.parse(savedSoundMuted);
            }
        }

        // Function to save settings to localStorage
        function saveSettings() {
            localStorage.setItem('payrollChecklistState', JSON.stringify(checklistState));
            localStorage.setItem('selectedPromotion', currentPromotion);
            localStorage.setItem('selectedSession', currentSession);
            localStorage.setItem('darkMode', JSON.stringify(isDarkMode));
            localStorage.setItem('soundMuted', JSON.stringify(isSoundMuted));
        }

        // Function to render the checklist and apply settings
        function renderChecklist() {
            // Render Academic Checklist
            const academicBody = document.getElementById('academic-checklist-body');
            academicBody.innerHTML = ''; // Clear previous content
            for (const item in checklistState.academic) {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                row.innerHTML = `
                    <td class="py-3 px-4 text-gray-800 text-base">${item}</td>
                    <td class="py-3 px-4 text-center">
                        <input type="checkbox" class="form-checkbox h-5 w-5 text-purple-600 rounded focus:ring-purple-500"
                               data-section="academic" data-item="${item}" data-subitem="Session 1"
                               ${checklistState.academic[item]['Session 1'] ? 'checked' : ''}>
                    </td>
                    <td class="py-3 px-4 text-center">
                        <input type="checkbox" class="form-checkbox h-5 w-5 text-purple-600 rounded focus:ring-purple-500"
                               data-section="academic" data-item="${item}" data-subitem="Session 2"
                               ${checklistState.academic[item]['Session 2'] ? 'checked' : ''}>
                    </td>
                `;
                academicBody.appendChild(row);
            }

            // Render General Preparation
            const generalList = document.getElementById('general-preparation-list');
            generalList.innerHTML = ''; // Clear previous content
            for (const item in checklistState.general) {
                const div = document.createElement('div');
                div.className = 'flex items-center bg-gray-50 p-3 rounded-lg shadow-sm';
                div.innerHTML = `
                    <input type="checkbox" id="general-${item.replace(/\s/g, '-')}" class="form-checkbox h-5 w-5 text-purple-600 rounded focus:ring-purple-500 mr-3"
                           data-section="general" data-item="${item}"
                           ${checklistState.general[item] ? 'checked' : ''}>
                    <label for="general-${item.replace(/\s/g, '-')}" class="text-gray-800 text-base cursor-pointer">
                        ${item}
                    </label>
                `;
                generalList.appendChild(div);
            }

            // Render Skill Blocks
            const skillBlocksContainer = document.getElementById('skill-blocks-container');
            skillBlocksContainer.innerHTML = ''; // Clear previous content
            ['bloc1', 'bloc2', 'bloc3'].forEach((blockKey, blockIndex) => {
                const progress = calculateBlockProgress(blockKey);
                const blockTitle = `Bloc ${blockIndex + 1} : ${
                    blockKey === 'bloc1' ? 'G√©rer la paie et les d√©clarations sociales' :
                    blockKey === 'bloc2' ? 'Assurer la Gestion administrative du personnel' :
                    'Conseiller et assister les d√©cideurs et les collaborateurs'
                }`;

                const blockDiv = document.createElement('div');
                blockDiv.className = 'mb-8 p-4 bg-purple-50 rounded-xl shadow-inner';
                blockDiv.innerHTML = `
                    <h3 class="text-xl sm:text-2xl font-semibold text-purple-800 mb-3">
                        ${blockTitle}
                    </h3>
                    <div class="w-full bg-gray-200 rounded-full h-4 mb-4">
                        <div class="bg-gradient-to-r from-purple-500 to-indigo-500 h-4 rounded-full text-xs font-medium text-white text-center p-0.5 leading-none"
                             style="width: ${progress}%">
                            ${progress}% compl√©t√©
                        </div>
                    </div>
                `;
                skillBlocksContainer.appendChild(blockDiv);

                for (const moduleName in checklistState[blockKey]) {
                    const moduleDiv = document.createElement('div');
                    moduleDiv.className = 'mb-4 bg-white p-4 rounded-xl shadow-md';
                    moduleDiv.innerHTML = `
                        <button class="w-full text-left font-semibold text-lg flex justify-between items-center text-gray-800 focus:outline-none collapsible-btn">
                            ${moduleName}
                            <svg class="w-5 h-5 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div class="collapsible-content hidden mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3">
                            </div>
                    `;
                    blockDiv.appendChild(moduleDiv);

                    const contentDiv = moduleDiv.querySelector('.collapsible-content');
                    for (const item in checklistState[blockKey][moduleName]) {
                        const itemDiv = document.createElement('div');
                        itemDiv.className = 'flex items-center bg-gray-50 p-3 rounded-lg shadow-sm';
                        itemDiv.innerHTML = `
                            <input type="checkbox" id="${blockKey}-${moduleName.replace(/\s/g, '-')}-${item.replace(/\s/g, '-')}" class="form-checkbox h-5 w-5 text-purple-600 rounded focus:ring-purple-500 mr-3"
                                   data-section="bloc${blockIndex + 1}" data-module="${moduleName}" data-item="${item}"
                                   ${checklistState[blockKey][moduleName][item] ? 'checked' : ''}>
                            <label for="${blockKey}-${moduleName.replace(/\s/g, '-')}-${item.replace(/\s/g, '-')}" class="text-gray-800 text-base cursor-pointer">
                                ${item}
                            </label>
                        `;
                        contentDiv.appendChild(itemDiv);
                    }
                }
            });

            // Render Well-being Checklist
            const wellbeingContainer = document.getElementById('wellbeing-checklist-container');
            wellbeingContainer.innerHTML = ''; // Clear previous content
            for (const category in checklistState.wellbeing) {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'mb-4 bg-white p-4 rounded-xl shadow-md';
                categoryDiv.innerHTML = `
                    <button class="w-full text-left font-semibold text-lg flex justify-between items-center text-gray-800 focus:outline-none collapsible-btn">
                        ${category}
                        <svg class="w-5 h-5 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                    <div class="collapsible-content hidden mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3">
                        </div>
                `;
                wellbeingContainer.appendChild(categoryDiv);

                const contentDiv = categoryDiv.querySelector('.collapsible-content');
                for (const item in checklistState.wellbeing[category]) {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'flex items-center bg-gray-50 p-3 rounded-lg shadow-sm';
                    itemDiv.innerHTML = `
                        <input type="checkbox" id="wellbeing-${category.replace(/\s/g, '-')}-${item.replace(/\s/g, '-')}" class="form-checkbox h-5 w-5 text-purple-600 rounded focus:ring-purple-500 mr-3"
                               data-section="wellbeing" data-category="${category}" data-item="${item}"
                               ${checklistState.wellbeing[category][item] ? 'checked' : ''}>
                        <label for="wellbeing-${category.replace(/\s/g, '-')}-${item.replace(/\s/g, '-')}" class="text-gray-800 text-base cursor-pointer">
                            ${item}
                        </label>
                    `;
                    contentDiv.appendChild(itemDiv);
                }
            }

            // Set the correct radio buttons for promotion and session selection
            document.getElementById(`promo${currentPromotion.charAt(0).toUpperCase() + currentPromotion.slice(1)}`).checked = true;
            document.getElementById(`radio${currentSession.charAt(0).toUpperCase() + currentSession.slice(1)}`).checked = true;

            // Apply dark mode setting
            if (isDarkMode) {
                document.body.classList.add('dark-mode');
                document.getElementById('darkModeToggle').textContent = 'üí° Mode Clair';
            } else {
                document.body.classList.remove('dark-mode');
                document.getElementById('darkModeToggle').textContent = 'üåì Mode Sombre';
            }

            // Set sound toggle button text
            document.getElementById('soundToggle').textContent = isSoundMuted ? 'üîá Son D√©sactiv√©' : 'üîä Son Activ√©';


            // Update Global Progress Bar
            updateGlobalProgressBar();

            // Attach event listeners after rendering
            attachEventListeners();
        }

        // Function to calculate progress for a given block
        function calculateBlockProgress(blockKey) {
            const block = checklistState[blockKey];
            if (!block) return 0;

            let totalItems = 0;
            let completedItems = 0;

            for (const moduleName in block) {
                const moduleItems = block[moduleName];
                for (const itemName in moduleItems) {
                    totalItems++;
                    if (moduleItems[itemName]) {
                        completedItems++;
                    }
                }
            }
            return totalItems > 0 ? Math.round((completedItems / totalItems) * 100) : 0;
        }

        // Function to calculate and update global progress
        function updateGlobalProgressBar() {
            let totalBlocks = 0;
            let totalPercentage = 0;

            if (checklistState.bloc1) {
                totalPercentage += calculateBlockProgress('bloc1');
                totalBlocks++;
            }
            if (checklistState.bloc2) {
                totalPercentage += calculateBlockProgress('bloc2');
                totalBlocks++;
            }
            if (checklistState.bloc3) {
                totalPercentage += calculateBlockProgress('bloc3');
                totalBlocks++;
            }

            const averageProgress = totalBlocks > 0 ? Math.round(totalPercentage / totalBlocks) : 0;
            const progressBar = document.querySelector('.global-progress-bar');
            if (progressBar) {
                progressBar.style.width = `${averageProgress}%`;
                progressBar.textContent = `${averageProgress}%`; // Only percentage
            }
        }


        // Function to handle checkbox changes
        function handleCheckboxChange(event) {
            const checkbox = event.target;
            const section = checkbox.dataset.section;
            const item = checkbox.dataset.item;
            const subItem = checkbox.dataset.subitem;
            const module = checkbox.dataset.module;
            const category = checkbox.dataset.category;

            if (section === 'academic') {
                checklistState[section][item][subItem] = checkbox.checked;
            } else if (section === 'general') {
                checklistState[section][item] = checkbox.checked;
            } else if (section.startsWith('bloc')) {
                checklistState[section][module][item] = checkbox.checked;
            } else if (section === 'wellbeing') {
                checklistState[section][category][item] = checkbox.checked;
            }
            playSound(); // Play sound on checkbox click
            saveSettings();
            renderChecklist(); // Re-render to update progress bars and state
        }

        // Function to attach event listeners to checkboxes and collapsible buttons
        function attachEventListeners() {
            // Checkboxes
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.removeEventListener('change', handleCheckboxChange); // Prevent duplicate listeners
                checkbox.addEventListener('change', handleCheckboxChange);
            });

            // Collapsible buttons for Skill Blocks and Wellbeing
            document.querySelectorAll('#skill-blocks-container .collapsible-btn, #wellbeing-checklist-container .collapsible-btn').forEach(button => {
                button.removeEventListener('click', toggleCollapsible); // Prevent duplicate listeners
                button.addEventListener('click', toggleCollapsible);
            });

            // Radio buttons for promotion selection
            document.querySelectorAll('input[name="promotion"]').forEach(radio => {
                radio.removeEventListener('change', handlePromotionChange);
                radio.addEventListener('change', handlePromotionChange);
            });

            // Radio buttons for promotion session
            document.querySelectorAll('input[name="promotionSession"]').forEach(radio => {
                radio.removeEventListener('change', handleSessionChange);
                radio.addEventListener('change', handleSessionChange);
            });

            // Dark Mode Toggle
            document.getElementById('darkModeToggle').removeEventListener('click', toggleDarkMode);
            document.getElementById('darkModeToggle').addEventListener('click', toggleDarkMode);

            // Sound Toggle
            document.getElementById('soundToggle').removeEventListener('click', toggleSound);
            document.getElementById('soundToggle').addEventListener('click', toggleSound);
        }

        // Function to handle main promotion change (e.g., Vinci, Pasteur, Copernic)
        function handlePromotionChange(event) {
            currentPromotion = event.target.value;
            saveSettings();
            updateCountdown(); // Update countdown immediately
        }

        // Function to handle session change (Session 1 or Session 2)
        function handleSessionChange(event) {
            currentSession = event.target.value;
            saveSettings();
            updateCountdown(); // Update countdown immediately
        }

        // Function to toggle collapsible sections for Skill Blocks and Wellbeing
        function toggleCollapsible(event) {
            const button = event.currentTarget;
            const content = button.nextElementSibling; // The div with class 'collapsible-content'
            const svg = button.querySelector('svg');

            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                svg.classList.add('rotate-180');
                playSound();
            } else {
                content.classList.add('hidden');
                svg.classList.remove('rotate-180');
                playSound();
            }
        }

        // Dark Mode Toggle Function
        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            saveSettings();
            renderChecklist(); // Re-render to apply new styles and update button text
        }

        // Sound Toggle Function
        function toggleSound() {
            isSoundMuted = !isSoundMuted;
            saveSettings();
            renderChecklist(); // Re-render to update button text
        }

        // Countdown logic
        function updateCountdown() {
            const targetPromotionInfo = promotionDates[currentPromotion];
            const targetDateInfo = targetPromotionInfo[currentSession];
            const targetDate = targetDateInfo.date;
            const now = new Date();
            const difference = targetDate.getTime() - now.getTime();
            const days = Math.ceil(difference / (1000 * 60 * 60 * 24));

            document.getElementById('days-remaining').textContent = days > 0 ? days : 0;
            document.getElementById('promotion-date').textContent = targetDateInfo.display;
            document.getElementById('current-promotion-display').textContent = targetPromotionInfo.name;
        }

        // Initial load and setup
        document.addEventListener('DOMContentLoaded', () => {
            loadSettings();
            renderChecklist();
            updateCountdown();
            setInterval(updateCountdown, 1000 * 60 * 60 * 24); // Update daily
        });
    </script>
</body>
</html>
